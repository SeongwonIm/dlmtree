<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="dlmtree">
<title>TDLMM â€¢ dlmtree</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="TDLMM">
<meta property="og:description" content="dlmtree">
<meta property="og:image" content="https://danielmork.github.io/dlmtree/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dlmtree</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-treed-dlm">Treed DLM</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-treed-dlm">
    <a class="dropdown-item" href="../articles/TDLM.html">TDLM</a>
    <a class="dropdown-item" href="../articles/TDLNM.html">TDLNM</a>
    <a class="dropdown-item" href="../articles/TDLMM.html">TDLMM</a>
    <a class="dropdown-item" href="../articles/HDLM.html">HDLM</a>
    <a class="dropdown-item" href="../articles/HDLMM.html">HDLMM</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/danielmork/dlmtree/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>TDLMM</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/danielmork/dlmtree/blob/HEAD/vignettes/articles/TDLMM.Rmd" class="external-link"><code>vignettes/articles/TDLMM.Rmd</code></a></small>
      <div class="d-none name"><code>TDLMM.Rmd</code></div>
    </div>

    
    
<p>This vignette demonstrates the implementation of treed distributed
lag mixture model (TDLMM). More details can be found in Mork and Wilson
(2023) &lt;doi: <a href="https://doi.org/10.1111/biom.13568" class="external-link">10.1111/biom.13568</a>&gt;.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/danielmork/dlmtree" class="external-link">dlmtree</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h3>
<p>Simulated data is available on <a href="https://github.com/danielmork/dlmtree/tree/master/vignettes/articles" class="external-link">GitHub</a>.
It can be loaded with the following code.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sbd_dlmtree</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_sbd_dlmtree.html">get_sbd_dlmtree</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-preparation">Data preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Response and covariates</span></span>
<span><span class="va">sbd_cov</span> <span class="op">&lt;-</span> <span class="va">sbd_dlmtree</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">bwgaz</span>, <span class="va">ChildSex</span>, <span class="va">MomAge</span>, <span class="va">GestAge</span>, <span class="va">MomPriorBMI</span>, <span class="va">Race</span>,</span>
<span>                    <span class="va">Hispanic</span>, <span class="va">MomEdu</span>, <span class="va">SmkAny</span>, <span class="va">Marital</span>, <span class="va">Income</span>,</span>
<span>                    <span class="va">EstDateConcept</span>, <span class="va">EstMonthConcept</span>, <span class="va">EstYearConcept</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Exposure data</span></span>
<span><span class="va">sbd_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>PM25 <span class="op">=</span> <span class="va">sbd_dlmtree</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"pm25_"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                TEMP <span class="op">=</span> <span class="va">sbd_dlmtree</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"temp_"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                SO2 <span class="op">=</span> <span class="va">sbd_dlmtree</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"so2_"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                CO <span class="op">=</span> <span class="va">sbd_dlmtree</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"co_"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                NO2 <span class="op">=</span> <span class="va">sbd_dlmtree</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"no2_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sbd_exp</span> <span class="op">&lt;-</span> <span class="va">sbd_exp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">as.matrix</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fitting-the-model">Fitting the model<a class="anchor" aria-label="anchor" href="#fitting-the-model"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tdlmm.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dlmtree.html">dlmtree</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">bwgaz</span> <span class="op">~</span> <span class="va">ChildSex</span> <span class="op">+</span> <span class="va">MomAge</span> <span class="op">+</span> <span class="va">MomPriorBMI</span> <span class="op">+</span></span>
<span>                                        <span class="va">Race</span> <span class="op">+</span> <span class="va">Hispanic</span> <span class="op">+</span> <span class="va">SmkAny</span> <span class="op">+</span> <span class="va">EstMonthConcept</span>,</span>
<span>                     data <span class="op">=</span> <span class="va">sbd_cov</span>,</span>
<span>                     exposure.data <span class="op">=</span> <span class="va">sbd_exp</span>,</span>
<span>                     family <span class="op">=</span> <span class="st">"gaussian"</span>, dlm.type <span class="op">=</span> <span class="st">"linear"</span>, mixture <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     mixture.interactions <span class="op">=</span> <span class="st">"noself"</span>,</span>
<span>                     n.burn <span class="op">=</span> <span class="fl">2500</span>, n.iter <span class="op">=</span> <span class="fl">10000</span>, n.thin <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Preparing data...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Running TDLMM:</span></span>
<span><span class="co">#&gt; Burn-in % complete </span></span>
<span><span class="co">#&gt; [0--------25--------50--------75--------100]</span></span>
<span><span class="co">#&gt;  ''''''''''''''''''''''''''''''''''''''''''</span></span>
<span><span class="co">#&gt; MCMC iterations (est time: 4 minutes)</span></span>
<span><span class="co">#&gt; [0--------25--------50--------75--------100]</span></span>
<span><span class="co">#&gt;  ''''''''''''''''''''''''''''''''''''''''''</span></span>
<span><span class="co">#&gt; Compiling results...</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-fit-summary">Model fit summary<a class="anchor" aria-label="anchor" href="#model-fit-summary"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Marginalization with co-exposure fixed at exact levels for each exposure</span></span>
<span><span class="va">tdlmm.sum.exact</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tdlmm.fit</span>, marginalize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reconstructing main effects...</span></span>
<span><span class="co">#&gt; Reconstructing interaction effects...</span></span>
<span><span class="co">#&gt; 0%...25%...50%...75%...100%</span></span>
<span><span class="co">#&gt; Calculating marginal effects...</span></span>
<span><span class="co">#&gt; Calculating fixed effects...</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Marginalization with co-exposure fixed at 25th percentile</span></span>
<span><span class="va">tdlmm.sum.percentile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tdlmm.fit</span>, marginalize <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reconstructing main effects...</span></span>
<span><span class="co">#&gt; Reconstructing interaction effects...</span></span>
<span><span class="co">#&gt; 0%...25%...50%...75%...100%</span></span>
<span><span class="co">#&gt; Calculating marginal effects...</span></span>
<span><span class="co">#&gt; Calculating fixed effects...</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Marginalization with co-exposure fixed at the empirical means (default)</span></span>
<span><span class="va">tdlmm.sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tdlmm.fit</span>, marginalize <span class="op">=</span> <span class="st">"mean"</span>, log10BF.crit <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reconstructing main effects...</span></span>
<span><span class="co">#&gt; Reconstructing interaction effects...</span></span>
<span><span class="co">#&gt; 0%...25%...50%...75%...100%</span></span>
<span><span class="co">#&gt; Calculating marginal effects...</span></span>
<span><span class="co">#&gt; Calculating fixed effects...</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tdlmm.sum</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; TDLMM summary</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model run info:</span></span>
<span><span class="co">#&gt; - bwgaz ~ ChildSex + MomAge + MomPriorBMI + Race + Hispanic + SmkAny + EstMonthConcept </span></span>
<span><span class="co">#&gt; - sample size: 10,000 </span></span>
<span><span class="co">#&gt; - family: gaussian </span></span>
<span><span class="co">#&gt; - 20 trees (alpha = 0.95, beta = 2)</span></span>
<span><span class="co">#&gt; - 2500 burn-in iterations</span></span>
<span><span class="co">#&gt; - 10000 post-burn iterations</span></span>
<span><span class="co">#&gt; - 5 thinning factor</span></span>
<span><span class="co">#&gt; - 5 exposures measured at 37 time points</span></span>
<span><span class="co">#&gt; - 10 two-way interactions (no-self interactions)</span></span>
<span><span class="co">#&gt; - 1 kappa sparsity prior</span></span>
<span><span class="co">#&gt; - 0.95 confidence level</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;                        Mean  Lower  Upper</span></span>
<span><span class="co">#&gt; *(Intercept)          0.172  0.043  0.307</span></span>
<span><span class="co">#&gt; *ChildSexM           -2.063 -2.085 -2.041</span></span>
<span><span class="co">#&gt;  MomAge               0.001 -0.001  0.002</span></span>
<span><span class="co">#&gt; *MomPriorBMI         -0.020 -0.022 -0.019</span></span>
<span><span class="co">#&gt;  RaceAsianPI          0.027 -0.058  0.117</span></span>
<span><span class="co">#&gt;  RaceBlack            0.033 -0.063  0.124</span></span>
<span><span class="co">#&gt;  Racewhite            0.016 -0.067  0.100</span></span>
<span><span class="co">#&gt; *HispanicNonHispanic  0.248  0.224  0.272</span></span>
<span><span class="co">#&gt; *SmkAnyY             -0.393 -0.441 -0.346</span></span>
<span><span class="co">#&gt;  EstMonthConcept2     0.073 -0.003  0.145</span></span>
<span><span class="co">#&gt; *EstMonthConcept3     0.107  0.009  0.211</span></span>
<span><span class="co">#&gt; *EstMonthConcept4     0.158  0.038  0.282</span></span>
<span><span class="co">#&gt; *EstMonthConcept5     0.255  0.126  0.388</span></span>
<span><span class="co">#&gt; *EstMonthConcept6     0.200  0.064  0.333</span></span>
<span><span class="co">#&gt; *EstMonthConcept7     0.223  0.084  0.354</span></span>
<span><span class="co">#&gt; *EstMonthConcept8     0.199  0.068  0.331</span></span>
<span><span class="co">#&gt; *EstMonthConcept9     0.291  0.164  0.418</span></span>
<span><span class="co">#&gt; *EstMonthConcept10    0.182  0.070  0.296</span></span>
<span><span class="co">#&gt; *EstMonthConcept11    0.135  0.040  0.236</span></span>
<span><span class="co">#&gt;  EstMonthConcept12    0.006 -0.062  0.077</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; * = CI does not contain zero</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --</span></span>
<span><span class="co">#&gt; Exposure effects: critical windows</span></span>
<span><span class="co">#&gt; * = Exposure selected by Bayes Factor</span></span>
<span><span class="co">#&gt; (x.xx) = Relative effect size</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  *PM25 (0.7): 11-20</span></span>
<span><span class="co">#&gt;  *TEMP (0.7): 5-19</span></span>
<span><span class="co">#&gt;  *SO2 (0.21): </span></span>
<span><span class="co">#&gt;  *CO (0.63): </span></span>
<span><span class="co">#&gt;  *NO2 (0.26): 23</span></span>
<span><span class="co">#&gt; --</span></span>
<span><span class="co">#&gt; Interaction effects: critical windows</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  PM25/TEMP (0.8):</span></span>
<span><span class="co">#&gt;  12/6-19</span></span>
<span><span class="co">#&gt;  13/6-19</span></span>
<span><span class="co">#&gt;  14/6-20</span></span>
<span><span class="co">#&gt;  15/6-20</span></span>
<span><span class="co">#&gt;  16/6-20</span></span>
<span><span class="co">#&gt;  17/6-21</span></span>
<span><span class="co">#&gt;  18/5-22</span></span>
<span><span class="co">#&gt;  19/5-22</span></span>
<span><span class="co">#&gt;  20/6-21</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; residual standard errors: 0.005</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="main-exposure-effect">Main exposure effect<a class="anchor" aria-label="anchor" href="#main-exposure-effect"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tdlmm.sum</span>, exposure1 <span class="op">=</span> <span class="st">"PM25"</span>, main <span class="op">=</span> <span class="st">"PM2.5"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tdlmm.sum</span>, exposure1 <span class="op">=</span> <span class="st">"TEMP"</span>, main <span class="op">=</span> <span class="st">"Temperature"</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tdlmm.sum</span>, exposure1 <span class="op">=</span> <span class="st">"SO2"</span>, main <span class="op">=</span> <span class="st">"SO2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span></span></code></pre></div>
<p><img src="TDLMM_files/figure-html/tdlmm.plot-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2</span></span></code></pre></div>
<p><img src="TDLMM_files/figure-html/tdlmm.plot-2.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p3</span></span></code></pre></div>
<p><img src="TDLMM_files/figure-html/tdlmm.plot-3.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="lagged-interaction-effect">Lagged interaction effect<a class="anchor" aria-label="anchor" href="#lagged-interaction-effect"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tdlmm.sum</span>, exposure1 <span class="op">=</span> <span class="st">"PM25"</span>, exposure2 <span class="op">=</span> <span class="st">"TEMP"</span><span class="op">)</span></span></code></pre></div>
<p><img src="TDLMM_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="adjusting-for-expected-changes-in-co-occurring-exposures">Adjusting for expected changes in co-occurring exposures<a class="anchor" aria-label="anchor" href="#adjusting-for-expected-changes-in-co-occurring-exposures"></a>
</h3>
<p>Here we consider going from the 25th to the 75th percentile in each
exposure while adjusting for the expected changes in other exposures due
to their correlations with the exposure of interest.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">dlm_coexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adj_coexposure.html">adj_coexposure</a></span><span class="op">(</span><span class="va">sbd_exp</span>, <span class="va">tdlmm.fit</span>, contrast_perc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;         PM25     TEMP       SO2       CO      NO2</span></span>
<span><span class="co">#&gt; 25% 5.183927 1.374847 0.9961942 2.098930 1.872199</span></span>
<span><span class="co">#&gt; 75% 6.187326 2.378621 1.9960009 3.096027 2.875369</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predicting PM25 at lower/upper values of PM25: 5.183927 6.187326</span></span>
<span><span class="co">#&gt; Predicting TEMP at lower/upper values of PM25: 1.886921 1.937889</span></span>
<span><span class="co">#&gt; Predicting SO2 at lower/upper values of PM25: 1.403909 1.672338</span></span>
<span><span class="co">#&gt; Predicting CO at lower/upper values of PM25: 2.477085 2.784547</span></span>
<span><span class="co">#&gt; Predicting NO2 at lower/upper values of PM25: 2.208032 2.409519</span></span>
<span><span class="co">#&gt; Predicting PM25 at lower/upper values of TEMP: 5.654899 5.701115</span></span>
<span><span class="co">#&gt; Predicting TEMP at lower/upper values of TEMP: 1.374847 2.378621</span></span>
<span><span class="co">#&gt; Predicting SO2 at lower/upper values of TEMP: 1.686905 1.353916</span></span>
<span><span class="co">#&gt; Predicting CO at lower/upper values of TEMP: 3.07044 2.314228</span></span>
<span><span class="co">#&gt; Predicting NO2 at lower/upper values of TEMP: 2.72529 1.952642</span></span>
<span><span class="co">#&gt; Predicting PM25 at lower/upper values of SO2: 5.589447 5.87508</span></span>
<span><span class="co">#&gt; Predicting TEMP at lower/upper values of SO2: 1.888874 1.841457</span></span>
<span><span class="co">#&gt; Predicting SO2 at lower/upper values of SO2: 0.9961942 1.996001</span></span>
<span><span class="co">#&gt; Predicting CO at lower/upper values of SO2: 2.446352 2.898562</span></span>
<span><span class="co">#&gt; Predicting NO2 at lower/upper values of SO2: 2.179354 2.554288</span></span>
<span><span class="co">#&gt; Predicting PM25 at lower/upper values of CO: 5.482744 5.85876</span></span>
<span><span class="co">#&gt; Predicting TEMP at lower/upper values of CO: 2.0984 1.659518</span></span>
<span><span class="co">#&gt; Predicting SO2 at lower/upper values of CO: 1.310125 1.617886</span></span>
<span><span class="co">#&gt; Predicting CO at lower/upper values of CO: 2.09893 3.096027</span></span>
<span><span class="co">#&gt; Predicting NO2 at lower/upper values of CO: 1.971065 2.673015</span></span>
<span><span class="co">#&gt; Predicting PM25 at lower/upper values of NO2: 5.529577 5.732295</span></span>
<span><span class="co">#&gt; Predicting TEMP at lower/upper values of NO2: 2.121927 1.660641</span></span>
<span><span class="co">#&gt; Predicting SO2 at lower/upper values of NO2: 1.297695 1.702796</span></span>
<span><span class="co">#&gt; Predicting CO at lower/upper values of NO2: 2.25247 2.968066</span></span>
<span><span class="co">#&gt; Predicting NO2 at lower/upper values of NO2: 1.872199 2.875369</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dlm_coexp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Effect</span>, ymin <span class="op">=</span> <span class="va">Lower</span>, ymax <span class="op">=</span> <span class="va">Upper</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Name</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="TDLMM_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Mork, Seongwon Im, Ander Wilson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
