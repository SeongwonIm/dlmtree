---
title: "HDLMM"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{HDLMM}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

This vignette demonstrates the implementation of heterogeneous treed distributed lag mixture model (HDLMM).

```{r setup}
library(dlmtree)
set.seed(1)
```

### Fitting the model
```{r hdlmm.fit}
# Gaussian
D <- sim.hdlmm(sim = "D", n = 5000)
fit <- dlmtree(formula = y ~ ., 
               data = D$dat,
               exposure.data = D$exposures,
               dlm.type = "linear", 
               family = "gaussian", 
               mixture = TRUE, 
               het = TRUE,
               mixture.interactions = "noself", 
               hdlm.modifiers = "all",
               n.burn = 2500, n.iter = 10000, n.thin = 5)
```

### Model fit summary
```{r hdlmm.sum}
fit_sum <- summary(fit)
fit_sum
```

### Launching Shiny app
```{r hdlmm.shiny}
# shiny(fit)
```

